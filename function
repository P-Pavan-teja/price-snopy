CREATE OR REPLACE FUNCTION GET_PRIMARY_KEY_COLUMNS(TABLE_NAME STRING)
RETURNS STRING
LANGUAGE SQL
AS
$$
  SELECT LISTAGG("column_name", ', ') 
  FROM TABLE(RESULT_SCAN(
    (SELECT SYSTEM$QUERY_HISTORY(
      'SHOW PRIMARY KEYS IN TABLE ' || TABLE_NAME, 
      1
    )[0]['QUERY_ID']::STRING)
  ))
$$;